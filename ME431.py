import matplotlib.pyplot as plt
import numpy as np
from scipy.optimize import curve_fit


def exponential_func(x, a, b):
    return a * np.exp(b * x)


def ME431_lab1():
    pos = np.array([0, 60, 120, 180, 240, 300, 360])
    polished = np.array([75.53730117, 57.18318535, 42.52891284, 28.62567035, 20.26701245, 13.06427753, 11.18923853])
    painted = np.array([65.47410525, 47.08603857, 32.52502248, 21.47837276, 15.98674103, 10.52241235, 8.797268541])

    # Fit the exponential model
    params_pol, covariance_pol = curve_fit(exponential_func, pos, polished, p0=(1, -0.1))
    params_pain, covariance_pain = curve_fit(exponential_func, pos, painted, p0=(1, -0.1))

    # Extract parameters a and b
    a_pol, b_pol = params_pol
    a_pain, b_pain = params_pain

    # Standard deviations of the parameters (square root of the diagonal of covariance matrix)
    perr_pol = np.sqrt(np.diag(covariance_pol))
    a_pol_err, b_pol_err = perr_pol
    perr_pain = np.sqrt(np.diag(covariance_pain))
    a_pain_err, b_pain_err = perr_pain

    # Compute 95% confidence intervals (assuming a normal distribution, 1.96 * standard error gives approx. 95%)
    confidence_interval = 1.96

    # Predict y values for the fit
    y_fit_pol = exponential_func(pos, a_pol, b_pol)
    y_fit_pain = exponential_func(pos, a_pain, b_pain)

    # Upper and lower bounds of the 95% confidence interval for the y-values
    y_fit_upper_pol = exponential_func(pos, a_pol + confidence_interval * a_pol_err,
                                       b_pol + confidence_interval * b_pol_err)
    y_fit_lower_pol = exponential_func(pos, a_pol - confidence_interval * a_pol_err,
                                       b_pol - confidence_interval * b_pol_err)
    y_fit_upper_pain = exponential_func(pos, a_pain + confidence_interval * a_pain_err,
                                        b_pain + confidence_interval * b_pain_err)
    y_fit_lower_pain = exponential_func(pos, a_pain - confidence_interval * a_pain_err,
                                        b_pain - confidence_interval * b_pain_err)

    # Plot the original data, best fit, and the 95% confidence interval
    plt.scatter(pos, polished, label='Polished Rod')
    plt.plot(pos, y_fit_pol, label=f'Fit: y = {a_pol:.2f} * exp({b_pol:.2f} * x)', color='red')

    plt.scatter(pos, painted, label='Painted Rod')
    plt.plot(pos, y_fit_pain, label=f'Fit: y = {a_pain:.2f} * exp({b_pain:.2f} * x)', color='red')

    # Plot the confidence intervals
    plt.fill_between(pos, y_fit_lower_pol, y_fit_upper_pol, color='gray', alpha=0.3, label='_')
    plt.fill_between(pos, y_fit_lower_pain, y_fit_upper_pain, color='gray', alpha=0.3, label='_')

    # Add legend and labels
    plt.legend()
    plt.xlabel('Distance from heater (mm)')
    plt.ylabel('Temperature above ambient (C)')
    plt.title('Exponential Fit with 95% Confidence Interval')
    plt.show()

    print(f"a = {a_pol} ± {a_pol_err}")
    print(f"b = {b_pol} ± {b_pol_err}")

    print(f"a = {a_pain} ± {a_pain_err}")
    print(f"b = {b_pain} ± {b_pain_err}")


def ME431_lab2():
    times_ss = np.array([0, 0.5, 1, 1.5, 2, 2.5, 3, 3.5, 4, 4.5, 5, 5.5, 6, 6.5, 7, 7.5, 8, 8.5, 9, 9.5, 10, 10.5, 11, 11.5, 12, 12.5, 13, 13.5, 14, 14.5, 15, 15.5, 16, 16.5, 17, 17.5, 18, 18.5, 19, 19.5, 20, 20.5, 21, 21.5, 22, 22.5, 23, 23.5, 24, 24.5, 25, 25.5, 26, 26.5, 27, 27.5, 28, 28.5, 29, 29.5, 30, 30.5, 31, 31.5, 32, 32.5, 33, 33.5, 34, 34.5, 35, 35.5, 36, 36.5, 37, 37.5, 38, 38.5, 39, 39.5, 40, 40.5, 41, 41.5, 42, 42.5, 43, 43.5, 44, 44.5, 45, 45.5, 46, 46.5, 47, 47.5, 48, 48.5, 49, 49.5, 50, 50.5, 51, 51.5, 52, 52.5, 53, 53.5, 54, 54.5, 55, 55.5, 56, 56.5, 57, 57.5, 58, 58.5, 59, 59.5, 60, 60.5, 61, 61.5, 62, 62.5, 63, 63.5, 64, 64.5, 65, 65.5, 66, 66.5, 67, 67.5, 68, 68.5, 69, 69.5, 70, 70.5, 71, 71.5, 72, 72.5, 73, 73.5, 74, 74.5, 75, 75.5, 76, 76.5, 77, 77.5, 78, 78.5, 79, 79.5, 80, 80.5, 81, 81.5, 82, 82.5, 83, 83.5, 84, 84.5, 85, 85.5, 86, 86.5, 87, 87.5, 88, 88.5, 89, 89.5, 90, 90.5, 91, 91.5, 92, 92.5, 93, 93.5, 94, 94.5, 95, 95.5, 96, 96.5, 97, 97.5, 98, 98.5, 99, 99.5, 100, 100.5, 101, 101.5, 102, 102.5, 103, 103.5, 104, 104.5, 105, 105.5, 106, 106.5, 107, 107.5, 108, 108.5, 109, 109.5, 110, 110.5, 111, 111.5, 112, 112.5, 113, 113.5, 114, 114.5, 115, 115.5, 116, 116.5, 117, 117.5, 118, 118.5, 119, 119.5, 120, 120.5, 121, 121.5, 122, 122.5, 123, 123.5, 124, 124.5, 125, 125.5, 126, 126.5, 127, 127.5, 128, 128.5, 129, 129.5, 130, 130.5, 131, 131.5, 132, 132.5, 133, 133.5, 134, 134.5])
    small_slow = np.array([76.408733, 75.962094, 75.233222, 74.938807, 74.674948, 74.369146, 73.968443, 73.348118, 72.893874, 72.53793, 72.132689, 72.027108, 71.425545, 71.186198, 70.580485, 70.001849, 69.701288, 69.327136, 69.003264, 68.679827, 68.232361, 67.848647, 67.646079, 67.108017, 66.895826, 66.450418, 66.047173, 65.753471, 65.297869, 64.790262, 64.592917, 64.095425, 63.659129, 63.297448, 62.893796, 62.559821, 62.163559, 61.962626, 61.594484, 61.033892, 60.709499, 60.354397, 60.171552, 59.822367, 59.394831, 59.065042, 58.78038, 58.629089, 58.341307, 57.943792, 57.468501, 57.184618, 56.649943, 56.450273, 56.019297, 55.56871, 55.515927, 55.418947, 54.971038, 54.630573, 54.231818, 53.91945, 53.47251, 53.458286, 53.18236, 52.963404, 52.737216, 52.217295, 52.051289, 51.546279, 51.290102, 51.007657, 50.881031, 50.459785, 50.100969, 49.879515, 49.535411, 49.188664, 48.974633, 48.719551, 48.297608, 48.018559, 47.731037, 47.515173, 47.147798, 46.984758, 46.733301, 46.516984, 46.348399, 46.127387, 45.87383, 45.474836, 45.078969, 45.145613, 44.864, 44.480115, 44.308294, 44.060396, 43.655176, 43.507715, 43.250961, 43.10759, 42.870153, 42.459129, 42.256951, 41.919493, 41.756544, 41.274888, 41.143243, 40.939834, 40.720983, 40.574262, 40.204146, 40.02016, 39.729529, 39.436245, 39.142766, 39.071413, 38.815208, 38.480251, 38.178704, 38.056094, 37.885936, 37.578937, 37.45743, 37.174524, 37.00558, 37.204389, 36.718574, 36.533457, 36.369104, 36.226121, 35.886892, 35.691192, 35.445414, 35.276245, 35.056561, 34.862488, 34.686412, 34.457753, 34.264755, 34.186512, 33.851194, 33.746523, 33.580761, 33.228774, 33.169888, 32.852156, 32.613448, 32.396154, 32.185739, 32.115812, 32.033425, 31.873029, 31.489845, 31.334287, 31.253682, 30.989958, 30.745882, 30.588564, 30.479576, 30.493706, 30.344553, 30.152303, 29.896579, 29.703094, 29.402219, 29.390877, 29.131699, 29.117716, 28.827893, 28.617653, 28.56022, 28.234534, 28.152353, 28.009228, 27.931837, 27.756356, 27.639913, 27.406157, 27.245035, 27.020527, 26.817387, 26.762459, 26.720506, 26.561944, 26.313617, 26.177003, 26.107436, 25.850795, 25.716159, 25.545801, 25.364164, 25.13424, 24.968967, 24.901857, 24.817581, 24.843253, 24.635564, 24.459663, 24.280232, 24.095672, 24.02733, 23.974516, 23.763385, 23.550039, 23.397064, 23.29376, 23.158948, 22.980393, 22.81789, 22.873752, 22.575787, 22.523852, 22.255677, 22.083947, 21.963162, 22.361654, 22.16107, 21.927641, 21.805669, 21.621865, 21.489309, 21.251131, 21.04011, 21.055463, 20.956235, 20.638509, 20.657056, 20.640723, 20.323137, 20.416549, 20.046458, 20.059476, 19.944649, 19.859264, 19.60929, 19.667602, 19.463949, 19.373766, 19.207352, 19.124202, 19.095894, 19.073727, 18.926787, 18.815023, 18.748508, 18.754092, 18.477986, 18.205226, 17.921192, 17.996298, 18.253163, 18.120452, 17.923974, 17.866195, 17.478797, 17.633882, 17.30858, 17.423526, 17.310217, 17.131663, 17.033843, 16.906113, 16.770648, 16.818476, 16.637043, 16.383255, 16.539165, 16.544134])
    small_slow = np.array([76.408733, 76.01015, 75.500295, 75.186718, 74.712414, 74.231271, 73.865949, 73.416588, 73.020896, 72.409599, 72.17013, 71.918781, 71.289355, 71.101035, 70.569426, 70.031769, 69.749648, 69.43348, 69.023704, 68.633315, 68.157532, 67.834991, 67.385122, 66.973166, 66.704805, 66.271726, 65.713338, 65.509241, 65.167082, 64.743521, 64.36495, 63.953607, 63.612539, 63.302337, 62.855195, 62.412217, 62.10307, 61.767026, 61.505826, 61.10653, 60.933639, 60.29984, 59.973181, 59.803023, 59.407263, 59.069356, 58.729131, 58.393818, 58.008239, 57.6887, 57.396961, 57.042507, 56.753341, 56.416552, 56.099092, 55.70917, 55.409426, 55.099628, 54.784788, 54.419074, 54.156678, 53.915994, 53.637889, 53.246621, 52.793625, 52.585787, 52.40155, 51.98625, 51.769802, 51.42226, 51.129805, 50.828182, 50.465739, 50.21999, 49.958497, 49.663326, 49.353648, 49.097291, 48.814889, 48.530396, 48.277799, 47.991185, 47.608198, 47.410681, 47.090244, 46.901618, 46.624738, 46.317567, 46.07786, 45.924507, 45.581916, 45.337716, 44.987574, 44.743677, 44.46778, 44.34289, 43.939692, 43.82375, 43.444298, 43.344359, 42.899197, 42.719779, 42.512051, 42.255605, 42.064698, 41.766734, 41.471674, 41.091644, 41.061375, 40.780408, 40.490193, 40.469229, 40.093856, 39.992136, 39.712995, 39.37532, 39.22782, 38.934794, 38.674969, 38.383105, 38.147371, 38.092166, 37.817104, 37.639498, 37.538558, 37.247317, 36.927446, 36.788207, 36.465256, 36.302002, 36.091445, 36.011756, 35.809208, 35.48989, 35.288884, 35.162833, 34.904039, 34.775776, 34.484151, 34.361048, 34.127216, 33.877658, 33.659667, 33.519678, 33.258306, 33.10639, 32.920964, 32.808213, 32.566815, 32.386587, 32.198954, 31.973562, 31.764614, 31.681885, 31.361164, 31.313492, 31.129849, 30.953135, 30.651262, 30.572947, 30.429768, 30.152505, 29.900251, 29.839465, 29.579102, 29.494365, 29.336716, 29.218891, 29.009292, 28.968272, 28.698916, 28.450376, 28.232871, 28.176879, 28.043334, 27.870226, 27.690827, 27.564576, 27.489525, 27.231034, 27.091973, 26.956697, 26.786662, 26.696844, 26.467739, 26.30498, 26.068157, 25.953172, 25.805163, 25.72572, 25.482489, 25.335793, 25.18672, 25.120159, 24.826631, 24.801365, 24.706649, 24.559563, 24.435663, 24.252326, 24.219217, 24.007638, 23.878401, 23.682104, 23.639714, 23.430732, 23.314526, 23.240989, 23.116969, 22.908012, 22.758966, 22.671171, 22.50385, 22.434619, 22.232181, 22.078677, 22.00981, 21.893081, 21.724518, 21.591549, 21.626706, 21.425743, 21.260072, 21.013406, 21.117069, 20.847622, 20.867, 20.584866, 20.495792, 20.40701, 20.210312, 20.340464, 20.061025, 19.868672, 19.908402, 19.740842, 19.58022, 19.523128, 19.340655, 19.19188, 19.159782, 19.121198, 19.050258, 19.010723, 18.856128, 18.682964, 18.509934, 18.427882, 18.432895, 18.175614, 18.106629, 17.868039, 17.990677, 17.888462, 17.675896, 17.733529, 17.400884, 17.493132, 17.272858, 17.206092, 17.157002, 17.014022, 16.847412, 16.789194, 16.723573, 16.751777, 16.493626, 16.341493, 16.520422, 16.348182])

    times_sf = np.array([0, 0.5, 1, 1.5, 2, 2.5, 3, 3.5, 4, 4.5, 5, 5.5, 6, 6.5, 7, 7.5, 8, 8.5, 9, 9.5, 10, 10.5, 11, 11.5, 12, 12.5, 13, 13.5, 14, 14.5, 15, 15.5, 16, 16.5, 17, 17.5, 18, 18.5, 19, 19.5, 20, 20.5, 21, 21.5, 22, 22.5, 23, 23.5, 24, 24.5, 25, 25.5, 26, 26.5, 27, 27.5, 28, 28.5, 29, 29.5, 30, 30.5, 31, 31.5, 32, 32.5, 33, 33.5, 34, 34.5, 35, 35.5, 36, 36.5, 37, 37.5, 38, 38.5, 39, 39.5, 40, 40.5, 41, 41.5, 42, 42.5, 43, 43.5, 44, 44.5, 45, 45.5, 46, 46.5, 47, 47.5, 48, 48.5, 49, 49.5, 50, 50.5, 51, 51.5, 52, 52.5, 53, 53.5, 54, 54.5, 55, 55.5, 56, 56.5, 57, 57.5, 58, 58.5, 59, 59.5, 60, 60.5, 61, 61.5, 62, 62.5, 63, 63.5, 64, 64.5, 65, 65.5, 66, 66.5, 67, 67.5, 68, 68.5, 69, 69.5, 70, 70.5, 71, 71.5, 72, 72.5, 73, 73.5, 74, 74.5, 75, 75.5, 76, 76.5, 77, 77.5, 78, 78.5, 79, 79.5, 80, 80.5, 81, 81.5, 82, 82.5, 83, 83.5, 84, 84.5, 85, 85.5, 86, 86.5, 87, 87.5, 88, 88.5, 89, 89.5, 90, 90.5, 91, 91.5, 92, 92.5, 93, 93.5, 94, 94.5, 95, 95.5, 96, 96.5, 97, 97.5, 98, 98.5, 99, 99.5, 100, 100.5, 101, 101.5, 102, 102.5, 103, 103.5, 104, 104.5, 105, 105.5, 106, 106.5, 107, 107.5, 108, 108.5, 109, 109.5, 110, 110.5, 111, 111.5, 112, 112.5, 113, 113.5, 114, 114.5, 115, 115.5, 116, 116.5])
    small_fast = np.array([76.303583, 75.881975, 75.401608, 74.742441, 74.489503, 73.803391, 73.53432, 73.088556, 72.471502, 72.064801, 71.634063, 71.081835, 70.789083, 70.366538, 69.871654, 69.330226, 68.908518, 68.377954, 67.848962, 67.497111, 67.18139, 66.554803, 66.073449, 65.663795, 65.271331, 64.695384, 64.278153, 64.237265, 63.586913, 63.113226, 62.58936, 62.133734, 61.742564, 61.547772, 60.841974, 60.618797, 60.163864, 59.775225, 59.469465, 59.042914, 58.668675, 58.207816, 57.996474, 57.749204, 57.410594, 56.919338, 56.67854, 56.250979, 55.811263, 55.405261, 54.888434, 54.576182, 54.30857, 53.738504, 53.411944, 53.170019, 52.637335, 52.265606, 51.81558, 51.686006, 51.27896, 50.965746, 50.487573, 50.358213, 49.863271, 49.620909, 49.211588, 49.015233, 48.583635, 48.146418, 47.945848, 47.680797, 47.320413, 46.945743, 46.701485, 46.377507, 46.070693, 45.745544, 45.606424, 45.078069, 44.823995, 44.355944, 44.166555, 43.691906, 43.520669, 43.347189, 42.987018, 42.710428, 42.395446, 42.164548, 41.863422, 41.663554, 41.223917, 40.861002, 40.825506, 40.429658, 40.262582, 39.789457, 39.559616, 39.363276, 39.304881, 39.097882, 38.657893, 38.432371, 38.069322, 37.87707, 37.409724, 37.301406, 37.023443, 36.805149, 36.459546, 36.217517, 36.176052, 36.132799, 35.76894, 35.814723, 35.464225, 35.298847, 34.800595, 34.755611, 34.444946, 34.416155, 34.182431, 33.704932, 33.482583, 33.251108, 33.24927, 33.009103, 32.711307, 32.561586, 32.288754, 32.047784, 31.706521, 31.63962, 31.386421, 31.355348, 31.046987, 30.788152, 30.642016, 30.442523, 30.128057, 29.976646, 29.852368, 29.569622, 29.274116, 29.124492, 28.880249, 28.801066, 28.767961, 28.527642, 28.411303, 28.184398, 28.160806, 27.841881, 27.723879, 27.548505, 27.231093, 27.142757, 26.854806, 26.797229, 26.561521, 26.359111, 26.179762, 25.931132, 25.851014, 25.762432, 25.602876, 25.314602, 25.410151, 25.120669, 24.833393, 24.696189, 24.640177, 24.534403, 24.442037, 24.253631, 24.108184, 23.926624, 23.588937, 23.678629, 23.4185, 23.223594, 23.166438, 23.042033, 22.750462, 22.656035, 22.531391, 22.155629, 22.22946, 22.107697, 21.825189, 21.613976, 21.593232, 21.223831, 21.239853, 21.048597, 20.780859, 20.648123, 20.509338, 20.28708, 20.19751, 20.122065, 20.123102, 19.879691, 19.870863, 19.84151, 19.756772, 19.565302, 19.586981, 19.411561, 19.250788, 19.137827, 19.000863, 18.825528, 18.836206, 18.686935, 18.493974, 18.264475, 18.304453, 17.994869, 18.139834, 18.129571, 18.011299, 18.071771, 18.066716, 17.86012, 17.877641, 17.622991, 17.374495, 17.149622, 17.025058, 17.153762, 17.365237, 16.983785])
    small_fast = np.array([76.303583, 75.726554, 75.413289, 74.692498, 74.252145, 73.727409, 73.310693, 72.709792, 72.163165, 71.765877, 71.13781, 70.772366, 70.322474, 70.006387, 69.303136, 68.851784, 68.504838, 67.970477, 67.409507, 67.073099, 66.789644, 66.178507, 65.759314, 65.361782, 64.916171, 64.415058, 63.952681, 63.754842, 63.214865, 62.761145, 62.379385, 61.859697, 61.664216, 61.203158, 60.616284, 60.284925, 59.780951, 59.551054, 59.10128, 58.638504, 58.334139, 57.804403, 57.47013, 57.068468, 56.771426, 56.358216, 56.044587, 55.584163, 55.071709, 54.903862, 54.4915, 54.138941, 53.734675, 53.427487, 53.09681, 52.755728, 52.357257, 51.99524, 51.604976, 51.260537, 51.063388, 50.597989, 50.199405, 50.035074, 49.590343, 49.392267, 48.840663, 48.64789, 48.286423, 47.927205, 47.576659, 47.299769, 47.042853, 46.755934, 46.361501, 46.077204, 45.819315, 45.534906, 45.173113, 44.733149, 44.543968, 44.33796, 44.058756, 43.693822, 43.371711, 43.173497, 42.815055, 42.523066, 42.262307, 42.007421, 41.760564, 41.554383, 40.995761, 40.758678, 40.65791, 40.371724, 40.177885, 39.765304, 39.44576, 39.224911, 39.116179, 38.818573, 38.480888, 38.283847, 37.832991, 37.610224, 37.334367, 37.240503, 36.961946, 36.758613, 36.502048, 36.086679, 36.043116, 35.788662, 35.544162, 35.172179, 34.949677, 34.844517, 34.603804, 34.405324, 34.152322, 33.960162, 33.662683, 33.400853, 33.156598, 32.949292, 32.856317, 32.551784, 32.207424, 32.124302, 31.83618, 31.632923, 31.370493, 31.202738, 30.987614, 30.808991, 30.625533, 30.52638, 30.285051, 29.944856, 29.707976, 29.605277, 29.479884, 29.228454, 28.996133, 28.728503, 28.66032, 28.492236, 28.300453, 28.016242, 27.929197, 27.669758, 27.416931, 27.347164, 27.069824, 27.119951, 26.775992, 26.538322, 26.427856, 26.19583, 26.072559, 25.858237, 25.624258, 25.53872, 25.437018, 25.079099, 25.157495, 24.862946, 24.815272, 24.592014, 24.517755, 24.226378, 24.106076, 23.926952, 23.778095, 23.66827, 23.38802, 23.216129, 23.11763, 23.092694, 22.756836, 22.666493, 22.528158, 22.379472, 22.147922, 22.089458, 21.893443, 21.674647, 21.724405, 21.428318, 21.278082, 21.154872, 21.129277, 20.934139, 20.751251, 20.704608, 20.443192, 20.416262, 20.220378, 19.978967, 19.902692, 19.949008, 19.718168, 19.453701, 19.494377, 19.356602, 19.177598, 18.998093, 18.808416, 18.864363, 18.631691, 18.69734, 18.461346, 18.224602, 18.221611, 18.064698, 17.975629, 17.739723, 17.752268, 17.537292, 17.419457, 17.233325, 17.273272, 17.084215, 17.16505, 16.903678, 16.864461, 16.654766, 16.490904, 16.380156, 16.382929, 16.338017, 16.220668, 16.028136])

    times_bs = np.array([0, 1, 1.5, 2, 2.5, 3, 3.5, 4, 4.5, 5, 5.5, 6, 6.5, 7, 7.5, 8, 8.5, 9, 9.5, 10, 10.5, 11, 11.5, 12, 12.5, 13, 13.5, 14, 14.5, 15, 15.5, 16, 16.5, 17, 17.5, 18, 18.5, 19, 19.5, 20, 20.5, 21, 21.5, 22, 22.5, 23, 23.5, 24, 24.5, 25, 25.5, 26, 26.5, 27, 27.5, 28, 28.5, 29, 29.5, 30, 30.5, 31, 31.5, 32, 32.5, 33, 33.5, 34, 34.5, 35, 35.5, 36, 36.5, 37, 37.5, 38, 38.5, 39, 39.5, 40, 40.5, 41, 41.5, 42, 42.5, 43, 43.5, 44, 44.5, 45, 45.5, 46, 46.5, 47, 47.5, 48, 48.5, 49, 49.5, 50, 50.5, 51, 51.5, 52, 52.5, 53, 53.5, 54, 54.5, 55, 55.5, 56, 56.5, 57, 57.5, 58, 58.5, 59, 59.5, 60, 60.5, 61, 61.5, 62, 62.5, 63, 63.5, 64, 64.5, 65, 65.5, 66, 66.5, 67, 67.5, 68, 68.5, 69, 69.5, 70, 70.5, 71, 71.5, 72, 72.5, 73, 73.5, 74, 74.5, 75, 75.5, 76, 76.5, 77, 77.5, 78, 78.5, 79, 79.5, 80, 80.5, 81, 81.5, 82, 82.5, 83, 83.5, 84, 84.5, 85, 85.5, 86, 86.5, 87, 87.5, 88, 88.5, 89, 89.5, 90, 90.5, 91, 91.5, 92, 92.5, 93, 93.5, 94, 94.5, 95, 95.5, 96, 96.5, 97, 97.5, 98, 98.5, 99, 99.5, 100, 100.5, 101, 101.5, 102, 102.5, 103, 103.5, 104, 104.5, 105, 105.5, 106, 106.5, 107, 107.5, 108, 108.5, 109, 109.5, 110, 110.5, 111, 111.5, 112, 112.5, 113, 113.5, 114, 114.5, 115, 115.5, 116, 116.5, 117, 117.5, 118, 118.5, 119, 119.5, 120, 120.5, 121, 121.5, 122, 122.5, 123, 123.5, 124, 124.5, 125, 125.5, 126, 126.5, 127, 127.5, 128, 128.5, 129, 129.5, 130, 130.5, 131, 131.5, 132, 132.5, 133, 133.5, 134, 134.5, 135, 135.5, 136, 136.5, 137, 137.5, 138, 138.5, 139, 139.5, 140, 140.5, 141, 141.5, 142, 142.5, 143, 143.5, 144, 144.5, 145, 145.5, 146, 146.5, 147, 147.5, 148, 148.5, 149, 149.5, 150, 150.5, 151, 151.5, 152, 152.5, 153, 153.5, 154, 154.5, 155, 155.5, 156, 156.5, 157, 157.5, 158, 158.5, 159, 159.5, 160, 160.5, 161, 161.5, 162, 162.5, 163, 163.5, 164, 164.5, 165, 165.5, 166, 166.5, 167, 167.5, 168, 168.5, 169, 169.5, 170, 170.5, 171, 171.5, 172, 172.5, 173, 173.5, 174, 174.5, 175, 175.5, 176, 176.5, 177, 177.5, 178, 178.5, 179, 179.5, 180, 180.5, 181, 181.5, 182, 182.5, 183, 183.5, 184, 184.5, 185, 185.5, 186, 186.5, 187, 187.5, 188, 188.5, 189, 189.5, 190, 190.5, 191, 191.5, 192, 192.5, 193, 193.5, 194, 194.5, 195, 195.5, 196, 196.5, 197, 197.5, 198, 198.5, 199, 199.5, 200, 200.5, 201, 201.5, 202, 202.5, 203, 203.5, 204, 204.5, 205, 205.5, 206, 206.5, 207, 207.5, 208, 208.5, 209, 209.5, 210, 210.5, 211, 211.5, 212, 212.5, 213, 213.5, 214, 214.5, 215, 215.5, 216, 216.5, 217, 217.5, 218, 218.5, 219, 219.5, 220, 220.5, 221, 221.5, 222, 222.5, 223, 223.5, 224, 224.5, 225, 225.5, 226, 226.5, 227, 227.5, 228, 228.5, 229, 229.5, 230, 230.5, 231, 231.5, 232, 232.5, 233, 233.5, 234, 234.5, 235, 235.5, 236, 236.5, 237, 237.5, 238, 238.5, 239, 239.5, 240, 240.5, 241, 241.5, 242, 242.5, 243, 243.5, 244, 244.5, 245, 245.5, 246, 246.5, 247, 247.5, 248, 248.5, 249, 249.5, 250, 250.5, 251, 251.5, 252, 252.5, 253, 253.5, 254, 254.5, 255, 255.5, 256, 256.5, 257, 257.5, 258, 258.5, 259, 259.5, 260, 260.5, 261, 261.5, 262, 262.5, 263, 263.5, 264, 264.5, 265, 265.5, 266, 266.5, 267, 267.5, 268, 268.5, 269, 269.5, 270, 270.5, 271, 271.5, 272, 272.5, 273, 273.5, 274, 274.5, 275, 275.5, 276, 276.5, 277, 277.5, 278, 278.5, 279, 279.5, 280, 280.5, 281, 281.5, 282, 282.5, 283, 283.5, 284, 284.5, 285, 285.5, 286, 286.5, 287, 287.5, 288, 288.5, 289, 289.5, 290, 290.5, 291, 291.5, 292, 292.5])
    big_slow = np.array([76.143576, 75.75944, 75.430882, 75.087554, 75.099851, 74.878927, 74.652698, 74.50673, 74.235455, 74.218699, 74.268643, 74.077504, 73.890593, 73.730493, 73.51685, 73.539919, 73.369271, 73.155394, 72.809525, 72.72214, 72.483836, 72.226487, 72.108543, 71.96334, 71.638885, 71.38445, 71.011221, 70.575275, 70.353487, 69.990068, 69.882925, 69.653649, 69.615935, 69.247415, 69.248391, 68.858473, 68.751952, 68.533825, 68.224122, 68.05377, 67.965162, 67.770688, 67.45159, 67.377905, 67.375148, 67.279396, 67.096786, 66.934082, 66.675752, 66.32895, 66.05399, 65.958997, 65.725727, 65.633434, 65.29199, 65.04525, 64.923808, 64.785831, 64.498038, 64.242679, 64.085026, 63.949309, 63.655211, 63.559621, 63.289597, 63.156962, 63.046983, 62.756694, 62.709824, 62.373507, 62.243126, 62.15876, 62.246824, 62.203349, 62.260151, 62.247621, 62.138497, 61.842243, 61.690343, 61.648384, 61.379602, 61.252184, 60.993764, 60.882539, 60.774814, 60.485545, 60.199111, 59.998665, 59.830591, 59.520701, 59.367289, 59.187053, 58.935994, 58.755737, 58.657613, 58.437222, 58.417599, 58.19184, 57.972663, 57.758434, 57.474546, 57.294624, 57.055428, 57.040078, 56.958906, 56.676029, 56.620528, 56.310344, 56.415222, 56.364198, 56.320903, 56.388613, 56.465177, 56.318301, 56.301054, 55.950365, 55.853423, 55.411639, 55.379475, 55.268392, 55.233506, 54.990577, 54.785098, 54.612663, 54.561868, 54.340966, 54.300732, 54.126625, 53.846957, 53.607534, 53.459248, 53.405258, 53.444239, 53.127352, 53.155108, 52.932518, 52.700375, 52.51209, 52.319275, 52.181786, 51.622264, 51.742488, 51.839625, 51.703634, 51.723896, 51.616553, 51.469929, 51.27996, 50.971364, 50.704848, 50.569077, 50.48964, 50.424702, 50.631383, 50.588822, 50.55102, 50.649055, 50.220899, 50.132935, 49.729215, 49.343464, 48.999817, 48.944815, 48.756689, 48.792135, 48.681116, 48.656126, 48.597158, 48.370824, 48.170065, 48.064772, 48.174506, 48.04413, 47.875613, 47.653746, 47.61005, 47.496383, 47.398587, 47.032165, 46.860626, 46.758768, 46.564318, 46.236094, 46.039833, 46.050444, 45.776192, 45.740411, 45.545231, 45.393908, 45.522916, 45.461261, 45.32878, 45.242616, 45.147968, 45.199519, 45.028408, 44.847234, 44.607805, 44.548038, 44.228645, 43.9223, 43.815806, 43.833482, 43.560876, 43.379131, 43.303083, 43.094863, 42.928129, 42.865268, 42.764369, 42.877789, 42.59541, 42.568768, 42.347147, 42.171431, 42.362794, 42.269478, 42.412596, 42.343981, 42.456143, 42.529611, 42.428415, 42.184258, 41.859381, 41.697472, 41.54383, 41.394954, 41.283838, 41.259044, 41.155013, 40.935275, 40.620092, 40.705569, 40.230364, 40.360617, 40.202788, 40.305314, 40.213708, 40.155785, 40.013296, 39.819472, 39.649883, 39.277027, 39.098736, 38.895748, 38.703576, 38.657785, 38.476707, 38.608619, 38.332808, 38.238433, 38.035751, 37.986834, 37.810662, 37.668545, 37.423529, 37.453004, 37.356457, 37.249803, 37.111935, 37.081893, 37.159301, 37.203166, 36.911309, 36.750711, 36.611051, 36.499888, 36.325561, 36.195569, 36.167914, 36.438954, 36.251725, 36.077234, 35.922925, 36.227018, 36.173102, 35.836865, 35.906017, 35.632137, 35.472234, 35.346188, 35.182535, 35.124488, 34.961799, 34.860229, 34.662619, 34.604493, 34.60405, 34.251393, 34.198512, 34.221175, 33.929955, 33.994862, 33.808113, 33.807624, 33.512598, 33.389315, 33.572435, 33.313662, 33.326974, 33.345918, 33.149001, 33.3445, 33.270597, 33.12502, 32.858123, 32.908168, 32.73259, 32.742237, 32.624684, 32.472028, 32.40035, 32.239764, 32.113902, 31.95881, 31.906217, 31.685399, 31.445966, 31.489235, 31.508077, 31.469598, 31.320005, 31.233944, 31.25105, 31.128656, 31.005774, 30.884742, 31.202136, 31.340268, 31.331475, 31.480185, 31.489728, 31.424848, 31.205257, 31.182995, 31.104309, 31.035373, 30.953754, 30.888518, 30.837641, 30.544745, 30.355445, 30.125571, 30.116155, 29.798755, 29.887491, 29.790737, 29.661066, 29.455433, 29.506654, 29.396732, 29.155003, 29.127656, 28.998893, 29.017848, 28.979167, 29.155525, 28.899417, 28.883843, 28.624479, 28.51118, 28.490007, 28.403594, 28.384024, 28.436801, 28.154695, 28.160799, 28.039986, 27.893876, 27.749404, 27.649633, 27.582351, 27.529212, 27.584269, 27.482636, 27.362093, 27.095915, 27.260994, 26.945688, 27.020413, 26.929312, 27.002575, 26.863402, 26.705605, 26.638354, 26.806964, 26.772086, 26.715135, 26.490614, 26.394048, 26.484814, 26.341946, 26.159762, 26.075239, 26.115595, 25.914169, 25.810032, 25.977747, 25.857815, 25.766561, 25.791584, 25.819156, 25.610476, 25.551088, 25.569803, 25.277085, 25.076215, 25.229012, 24.987609, 24.848821, 24.731508, 24.792853, 24.564274, 24.428265, 24.346379, 24.090626, 24.304954, 24.25412, 24.263168, 24.136909, 24.14215, 24.164565, 24.491985, 24.398279, 24.300894, 24.51975, 24.373304, 24.39747, 24.418362, 24.400357, 24.377157, 24.198179, 23.99962, 24.1465, 23.963165, 23.996732, 23.762872, 23.574502, 23.360034, 23.245739, 23.142369, 22.979439, 22.787878, 22.623973, 22.727234, 22.697872, 22.597033, 22.612485, 22.644749, 22.406549, 22.360876, 22.230608, 22.152165, 22.080887, 22.002997, 22.03373, 21.972039, 21.904998, 21.882717, 22.115322, 22.143808, 22.055585, 22.155209, 21.888661, 21.832658, 21.665477, 21.629384, 21.550682, 21.251644, 21.337954, 21.267161, 21.202831, 21.08757, 20.994382, 20.881208, 20.896004, 20.74409, 20.928465, 20.844222, 20.639941, 20.560067, 20.553537, 20.471541, 20.332976, 20.231308, 20.248843, 20.200302, 20.190516, 20.161968, 20.278428, 20.372028, 20.211516, 20.320671, 20.333844, 20.16972, 19.989161, 20.11507, 20.12796, 20.119153, 19.958697, 19.822948, 19.707514, 19.719275, 19.710355, 19.447515, 19.585271, 19.471849, 19.41358, 19.487245, 19.35314, 19.560441, 19.48978, 19.605738, 19.715492, 19.679918, 19.66723, 19.526631, 19.491449, 19.520141, 19.398988, 19.466168, 19.129913, 19.1662, 18.844389, 18.827823, 18.596293, 18.601486, 18.748057, 18.642312, 18.613839, 18.594089, 18.667422, 18.777447, 18.567547, 18.575425, 18.407153, 18.432658, 18.14049, 18.16201, 17.903681, 17.876932, 17.819426, 17.621693, 17.48953, 17.399522, 17.479384, 17.173633, 17.253525, 17.219723, 17.082563, 17.153117, 16.995687, 17.105723, 16.923183, 16.974332, 17.069433, 17.328967, 17.135503, 17.160629, 17.101106, 17.057694, 16.857827, 16.788471, 16.905223, 16.727366, 16.75637, 16.891395, 16.89823, 16.858382, 16.824196, 16.78018, 16.505219, 16.518975, 16.390523, 16.385309, 16.325077, 16.055564, 16.046099, 16.104856, 15.895813, 15.950204, 15.9105, 15.88516, 15.903575, 15.672029])
    big_slow = np.array([76.143576, 75.931526, 75.713734, 75.627856, 75.365304, 75.137584, 74.883352, 74.787134, 74.608918, 74.315715, 74.151864, 73.955662, 73.739793, 73.541206, 73.255173, 73.238609, 73.065083, 72.893903, 72.539066, 72.542988, 72.337263, 71.982325, 71.827262, 71.630688, 71.470937, 71.301538, 71.002138, 70.991639, 70.803875, 70.409849, 70.446751, 70.111301, 70.106543, 69.700549, 69.589282, 69.326305, 69.197356, 68.99895, 68.883827, 68.594024, 68.535894, 68.252202, 68.21105, 67.965011, 67.766996, 67.643554, 67.401082, 67.157424, 67.071059, 66.915837, 66.693481, 66.504142, 66.30151, 66.18021, 66.033934, 65.77908, 65.604697, 65.508577, 65.230738, 65.045371, 64.912146, 64.762365, 64.658086, 64.476757, 64.314017, 64.082163, 64.032787, 63.670393, 63.608353, 63.299447, 63.127267, 63.038408, 62.993092, 62.746106, 62.427908, 62.338086, 62.23659, 62.010572, 61.873638, 61.749805, 61.509354, 61.342114, 61.186747, 61.056652, 60.887549, 60.78345, 60.662991, 60.469559, 60.403864, 60.152323, 60.029469, 59.839996, 59.620062, 59.43944, 59.289474, 59.070917, 58.942407, 58.80953, 58.627519, 58.510586, 58.439756, 58.333462, 58.005731, 57.850316, 57.841873, 57.540895, 57.4546, 57.270755, 57.190029, 57.130992, 56.805656, 56.601974, 56.515606, 56.377634, 56.199286, 56.060617, 55.942636, 55.729169, 55.61361, 55.460879, 55.34423, 55.178504, 55.077445, 54.754426, 54.843246, 54.652743, 54.419904, 54.312091, 54.148411, 54.011754, 53.7653, 53.698641, 53.648037, 53.420466, 53.367189, 53.06974, 52.99493, 52.744062, 52.710824, 52.650437, 52.391831, 52.331666, 52.191868, 52.002831, 51.909183, 51.69778, 51.677527, 51.517029, 51.334629, 51.128001, 51.175274, 50.882076, 50.914537, 50.698136, 50.577087, 50.488028, 50.303012, 49.986881, 50.095561, 49.971411, 49.754572, 49.646072, 49.552598, 49.303419, 49.173444, 49.0856, 49.006715, 48.841322, 48.54507, 48.580954, 48.428002, 48.365754, 48.122684, 48.160119, 47.904807, 47.767447, 47.616584, 47.562859, 47.383241, 47.34881, 47.233172, 46.926418, 46.840334, 46.725701, 46.568941, 46.499229, 46.387514, 46.140202, 46.086884, 46.06331, 45.826051, 45.692543, 45.635705, 45.51746, 45.507185, 45.339097, 45.264965, 45.022247, 44.992267, 44.888812, 44.812758, 44.536938, 44.570138, 44.362929, 44.179336, 44.12349, 43.96075, 43.806647, 43.757071, 43.637862, 43.480438, 43.404141, 43.36199, 43.168388, 42.874889, 42.970873, 42.783602, 42.842742, 42.557084, 42.535028, 42.375498, 42.265299, 42.07382, 41.940111, 41.875144, 41.811818, 41.652069, 41.502777, 41.414458, 41.328316, 41.091449, 40.981151, 40.985973, 40.903814, 40.884143, 40.65935, 40.510625, 40.40965, 40.324518, 40.234567, 40.248895, 40.038065, 39.880727, 39.705962, 39.744436, 39.539093, 39.455838, 39.272925, 39.314136, 39.120163, 39.113142, 38.942767, 38.847247, 38.853735, 38.621751, 38.446817, 38.375814, 38.380578, 38.254565, 38.114796, 38.133144, 37.877487, 37.884464, 37.667148, 37.587497, 37.518009, 37.419538, 37.270583, 37.201719, 37.020341, 37.037775, 36.870853, 36.890085, 36.659628, 36.603051, 36.535099, 36.331951, 36.261123, 36.194714, 36.046868, 35.87607, 35.870322, 35.817259, 35.552818, 35.671576, 35.509717, 35.392194, 35.408309, 35.230453, 35.156611, 35.103742, 35.007349, 34.867885, 34.771275, 34.738262, 34.594404, 34.410267, 34.45374, 34.298707, 34.172431, 34.077234, 33.953722, 33.924719, 33.893137, 33.670222, 33.599903, 33.574684, 33.44561, 33.283192, 33.33939, 33.189348, 33.134519, 33.074557, 32.791035, 32.732065, 32.75833, 32.584489, 32.469833, 32.464448, 32.333951, 32.305646, 32.256964, 32.070506, 32.13158, 31.985106, 31.830243, 31.701689, 31.713196, 31.504811, 31.461599, 31.433401, 31.342886, 31.281668, 31.080504, 31.048949, 30.950276, 30.805196, 30.747639, 30.681547, 30.640285, 30.601745, 30.62086, 30.449223, 30.420182, 30.058419, 30.181802, 29.96469, 29.999801, 29.825439, 29.918043, 29.745717, 29.657907, 29.439483, 29.523184, 29.400517, 29.331666, 29.302676, 29.206238, 28.968124, 28.937273, 28.974631, 28.99125, 28.815954, 28.643676, 28.703499, 28.526857, 28.44641, 28.346124, 28.280208, 28.21354, 28.052952, 28.039089, 28.012789, 27.949014, 27.923927, 27.772025, 27.758233, 27.753687, 27.562472, 27.553979, 27.305855, 27.448785, 27.262571, 27.231204, 27.136382, 27.041083, 26.943466, 26.931046, 26.899782, 26.724502, 26.771495, 26.602057, 26.525905, 26.619574, 26.469273, 26.295649, 26.176333, 26.270448, 26.00338, 25.946022, 25.921522, 25.906829, 25.724083, 25.767938, 25.756883, 25.646927, 25.547894, 25.546615, 25.401637, 25.385508, 25.316431, 25.349382, 25.145224, 25.022759, 24.979174, 24.834901, 24.920855, 24.77445, 24.889889, 24.570259, 24.616273, 24.539681, 24.448957, 24.532934, 24.255301, 24.235236, 24.237908, 24.146137, 24.077653, 24.109042, 23.987064, 23.838794, 23.644766, 23.90061, 23.772165, 23.821824, 23.58325, 23.505938, 23.429592, 23.365052, 23.318931, 23.262421, 23.252127, 23.176734, 23.103297, 23.004312, 23.015163, 22.970286, 22.814285, 22.75829, 22.757343, 22.682868, 22.566927, 22.438449, 22.31694, 22.361366, 22.376688, 22.28963, 22.179548, 22.159334, 22.166235, 22.076023, 22.069882, 21.856881, 21.898732, 21.866905, 21.812625, 21.682768, 21.595531, 21.631522, 21.509184, 21.326606, 21.379079, 21.400792, 21.309202, 21.295614, 21.141079, 21.130322, 21.130379, 20.998123, 20.950428, 20.954071, 20.822406, 20.815658, 20.661138, 20.6613, 20.653223, 20.495919, 20.492116, 20.62144, 20.280341, 20.321408, 20.261228, 20.210929, 20.110128, 20.074434, 20.069148, 19.996255, 20.010582, 19.734081, 19.847483, 19.771879, 19.823531, 19.589685, 19.49392, 19.676923, 19.475719, 19.351918, 19.441079, 19.323542, 19.350804, 19.286985, 19.18243, 19.243094, 19.103477, 19.000795, 18.971547, 18.873011, 19.011227, 18.748141, 18.878777, 18.774613, 18.694598, 18.596727, 18.619877, 18.470204, 18.477089, 18.466353, 18.34549, 18.296023, 18.397052, 18.202024, 18.157155, 18.087503, 18.099433, 17.959442, 18.021112, 17.874238, 17.912673, 17.827878, 17.812011, 17.743565, 17.624352, 17.646239, 17.574321, 17.531805, 17.440585, 17.496065, 17.488234, 17.463888, 17.381122, 17.251694, 17.284548, 17.136689, 17.054785, 17.15701, 17.08249, 16.96568, 16.953766, 16.776832, 16.893135, 16.845052, 16.733437, 16.723271, 16.551071, 16.527156, 16.736342, 16.50757, 16.471633, 16.457458, 16.466415, 16.164745, 16.231078, 16.281102, 16.289903, 16.106447, 16.08157, 16.035328, 16.058166, 15.942731, 15.948762, 16.057324, 16.007302, 15.964128, 15.856442])

    times_bf = np.array([0, 0.5, 1, 1.5, 2, 2.5, 3, 3.5, 4, 4.5, 5, 5.5, 6, 6.5, 7, 7.5, 8, 8.5, 9, 9.5, 10, 10.5, 11, 11.5, 12, 12.5, 13, 13.5, 14, 14.5, 15, 15.5, 16, 16.5, 17, 17.5, 18, 18.5, 19, 19.5, 20, 20.5, 21, 21.5, 22, 22.5, 23, 23.5, 24, 24.5, 25, 25.5, 26, 26.5, 27, 27.5, 28, 28.5, 29, 29.5, 30, 30.5, 31, 31.5, 32, 32.5, 33, 33.5, 34, 34.5, 35, 35.5, 36, 36.5, 37, 37.5, 38, 38.5, 39, 39.5, 40, 40.5, 41, 41.5, 42, 42.5, 43, 43.5, 44, 44.5, 45, 45.5, 46, 46.5, 47, 47.5, 48, 48.5, 49, 49.5, 50, 50.5, 51, 51.5, 52, 52.5, 53, 53.5, 54, 54.5, 55, 55.5, 56, 56.5, 57, 57.5, 58, 58.5, 59, 59.5, 60, 60.5, 61, 61.5, 62, 62.5, 63, 63.5, 64, 64.5, 65, 65.5, 66, 66.5, 67, 67.5, 68, 68.5, 69, 69.5, 70, 70.5, 71, 71.5, 72, 72.5, 73, 73.5, 74, 74.5, 75, 75.5, 76, 76.5, 77, 77.5, 78, 78.5, 79, 79.5, 80, 80.5, 81, 81.5, 82, 82.5, 83, 83.5, 84, 84.5, 85, 85.5, 86, 86.5, 87, 87.5, 88, 88.5, 89, 89.5, 90, 90.5, 91, 91.5, 92, 92.5, 93, 93.5, 94, 94.5, 95, 95.5, 96, 96.5, 97, 97.5, 98, 98.5, 99, 99.5, 100, 100.5, 101, 101.5, 102, 102.5, 103, 103.5, 104, 104.5, 105, 105.5, 106, 106.5, 107, 107.5, 108, 108.5, 109, 109.5, 110, 110.5, 111, 111.5, 112, 112.5, 113, 113.5, 114, 114.5, 115, 115.5, 116, 116.5, 117, 117.5, 118, 118.5, 119, 119.5, 120, 120.5, 121, 121.5, 122, 122.5, 123, 123.5, 124, 124.5, 125, 125.5, 126, 126.5, 127, 127.5, 128, 128.5, 129, 129.5, 130, 130.5, 131, 131.5, 132, 132.5, 133, 133.5, 134, 134.5, 135, 135.5, 136, 136.5, 137, 137.5, 138, 138.5, 139, 139.5, 140, 140.5, 141, 141.5, 142, 142.5, 143, 143.5, 144, 144.5, 145, 145.5, 146, 146.5, 147, 147.5, 148, 148.5, 149, 149.5, 150, 150.5, 151, 151.5, 152, 152.5, 153, 153.5, 154, 154.5, 155, 155.5, 156, 156.5, 157, 157.5, 158, 158.5, 159, 159.5, 160, 160.5, 161, 161.5, 162, 162.5, 163, 163.5, 164, 164.5, 165, 165.5, 166, 166.5, 167, 167.5, 168, 168.5, 169, 169.5, 170, 170.5, 171, 171.5, 172, 172.5, 173, 173.5, 174, 174.5, 175, 175.5, 176, 176.5, 177, 177.5, 178, 178.5, 179, 179.5, 180, 180.5, 181, 181.5, 182, 182.5, 183, 183.5, 184, 184.5, 185, 185.5, 186, 186.5, 187, 187.5, 188, 188.5, 189, 189.5, 190, 190.5, 191, 191.5, 192, 192.5, 193, 193.5, 194, 194.5, 195, 195.5, 196, 196.5, 197, 197.5, 198, 198.5, 199, 199.5, 200, 200.5, 201, 201.5, 202, 202.5, 203, 203.5, 204, 204.5, 205, 205.5, 206, 206.5, 207, 207.5, 208, 208.5, 209, 209.5, 210, 210.5, 211, 211.5, 212, 212.5, 213, 213.5, 214, 214.5, 215, 215.5, 216, 216.5, 217, 217.5, 218, 218.5, 219, 219.5, 220, 220.5, 221, 221.5, 222, 222.5, 223, 223.5, 224, 224.5, 225, 225.5, 226, 226.5, 227, 227.5, 228, 228.5, 229, 229.5, 230, 230.5, 231, 231.5, 232, 232.5, 233, 233.5, 234, 234.5, 235, 235.5, 236, 236.5, 237, 237.5, 238, 238.5, 239, 239.5, 240, 240.5, 241, 241.5, 242, 242.5, 243, 243.5, 244, 244.5, 245, 245.5, 246, 246.5, 247, 247.5, 248, 248.5, 249, 249.5, 250, 250.5, 251, 251.5, 252, 252.5, 253, 253.5, 254, 254.5, 255, 255.5, 256, 256.5, 257, 257.5, 258, 258.5, 259, 259.5, 260, 260.5, 261, 261.5, 262, 262.5, 263, 263.5, 264, 264.5, 265, 265.5, 266, 266.5, 267, 267.5, 268])
    big_fast = np.array([75.867571, 75.706661, 75.33359, 75.270297, 75.033123, 75.089664, 74.887737, 74.931241, 74.874753, 74.758185, 74.649405, 74.546969, 74.303696, 74.146942, 74.036633, 73.847338, 73.684177, 73.451687, 73.150395, 72.885, 72.602439, 72.257285, 72.066781, 71.878259, 71.644074, 71.486733, 71.314765, 71.018176, 70.786743, 70.530612, 70.409743, 70.050803, 69.767382, 69.704264, 69.244414, 69.118273, 68.911549, 68.873211, 68.573383, 68.478281, 68.124946, 67.863945, 67.795778, 67.298399, 67.000556, 66.737, 66.51313, 66.246982, 66.046495, 65.668576, 65.604871, 65.15997, 64.972625, 64.79553, 64.504969, 64.304987, 64.026854, 63.795373, 63.60397, 63.459745, 63.232832, 62.966612, 62.963184, 62.918339, 62.736737, 62.650694, 62.625632, 62.384603, 62.214003, 61.941451, 61.868305, 62.072667, 61.883856, 61.572306, 61.380308, 61.00341, 60.824308, 60.536414, 60.567166, 60.702293, 60.756988, 60.607718, 60.480763, 60.248753, 59.998355, 59.730741, 59.611711, 59.460314, 59.434669, 59.217566, 59.117206, 59.090749, 58.935974, 58.912222, 58.61723, 58.357988, 58.335768, 57.996066, 58.090482, 57.923095, 57.73519, 57.471845, 57.360656, 57.185689, 56.902212, 56.634597, 56.273926, 55.877349, 55.663945, 55.305663, 54.980117, 54.941865, 54.475804, 54.293664, 54.278912, 53.959109, 53.653358, 53.742556, 53.530294, 53.43449, 53.29207, 52.990561, 52.860262, 52.738296, 52.766627, 52.474279, 52.311335, 52.12774, 51.949409, 51.908184, 51.726791, 51.821037, 51.696966, 51.500342, 51.246582, 51.086151, 50.80268, 50.574467, 50.595404, 50.412631, 50.156746, 50.365357, 49.993284, 49.849129, 49.718534, 49.597607, 49.257104, 49.030169, 49.019754, 48.703117, 48.60318, 48.472569, 48.609999, 48.737722, 48.938638, 49.019092, 48.97734, 48.93926, 48.632306, 48.487489, 48.295337, 48.266452, 48.176235, 48.153241, 48.175726, 47.880929, 47.908847, 47.824124, 47.593434, 47.156935, 46.947298, 46.723723, 46.650293, 46.342537, 46.325321, 46.213524, 46.040429, 45.904505, 45.799229, 45.846469, 45.765841, 45.445544, 45.339188, 45.090346, 44.822574, 44.733478, 44.603764, 44.383191, 44.182728, 44.192201, 43.935332, 43.894212, 43.764955, 43.597524, 43.638478, 43.567079, 43.500458, 43.546744, 43.259504, 43.237186, 43.278479, 42.847997, 42.800446, 42.812923, 42.456848, 42.421511, 42.340935, 41.998222, 41.679812, 41.337785, 41.280703, 41.050819, 40.698105, 40.512583, 40.389649, 40.216314, 40.247901, 40.246219, 40.439857, 40.516359, 40.429145, 40.35581, 40.452069, 40.242565, 39.910131, 39.781879, 39.729456, 39.420326, 39.257981, 39.011508, 38.965829, 38.894147, 39.044078, 38.976913, 39.087179, 39.103413, 39.038179, 38.955569, 39.026342, 38.99589, 38.896488, 38.847474, 38.685354, 38.677056, 38.697915, 38.515997, 38.245154, 38.130771, 38.034056, 37.863667, 37.821522, 37.521479, 37.350885, 37.345143, 37.126717, 37.049208, 36.964648, 36.735594, 36.71844, 36.388938, 36.264864, 36.162178, 35.916893, 35.819465, 35.78868, 35.552291, 35.611867, 35.552424, 35.620608, 35.574897, 35.660836, 35.445958, 35.314619, 34.897899, 34.76912, 34.452211, 34.295156, 34.101446, 33.876049, 33.766538, 33.620793, 33.421859, 33.329939, 33.177842, 33.122228, 32.965033, 32.978128, 32.97937, 32.969691, 33.128991, 33.08993, 33.034362, 32.9652, 32.821147, 32.541861, 32.495414, 32.125659, 32.110911, 31.730855, 31.858082, 31.735511, 31.707459, 31.786866, 31.710392, 31.517122, 31.430883, 31.452201, 31.22661, 31.052352, 30.946495, 30.823834, 30.730877, 30.52471, 30.410451, 30.312677, 30.256372, 30.498184, 30.653042, 30.603139, 30.591952, 30.562573, 30.384877, 30.064269, 29.965668, 29.942846, 29.889183, 29.741885, 29.594854, 29.408171, 29.278458, 29.119344, 29.016335, 28.697539, 28.607145, 28.641975, 28.45364, 28.454202, 28.463104, 28.521312, 28.544617, 28.757131, 28.715841, 28.839689, 28.691113, 28.529123, 28.504921, 28.179367, 28.07711, 27.948602, 27.719959, 27.583059, 27.371985, 27.093103, 26.933967, 27.013059, 26.870079, 26.85564, 26.643383, 26.784289, 26.655086, 26.576581, 26.588446, 26.701509, 26.721609, 26.660512, 26.543311, 26.616135, 26.574985, 26.466187, 26.436688, 26.274722, 25.969945, 25.933754, 25.790745, 25.771973, 25.847018, 25.777933, 25.703029, 25.697528, 25.575213, 25.429482, 25.396694, 25.288483, 25.027016, 25.195151, 25.225679, 25.188868, 24.928701, 24.947555, 24.749466, 24.941803, 24.816601, 24.621745, 24.488689, 24.365759, 24.223973, 24.18995, 24.067334, 23.730962, 23.679103, 23.567061, 23.497168, 23.515863, 23.4775, 23.339333, 23.468772, 23.485195, 23.452628, 23.358187, 23.255406, 23.084286, 23.165497, 23.168, 23.187225, 22.93797, 22.852079, 22.754038, 22.659549, 22.794123, 22.688238, 22.517008, 22.453233, 22.457104, 22.62932, 22.743502, 22.589472, 22.646406, 22.535157, 22.29976, 22.331873, 22.224911, 21.983756, 22.017288, 22.287864, 22.279808, 22.225711, 22.166665, 21.8758, 21.827445, 21.98901, 21.661308, 21.793351, 21.858837, 21.512801, 21.341502, 21.361947, 21.246769, 21.036949, 20.940423, 20.928279, 21.079487, 21.009486, 21.159785, 21.058017, 20.828848, 20.732643, 20.794301, 20.569065, 20.265806, 20.342257, 20.195656, 20.184125, 19.956506, 19.941321, 19.711444, 19.643585, 19.825269, 19.604204, 19.46124, 19.415193, 19.452125, 19.038702, 19.278957, 19.54905, 19.43562, 19.689514, 19.776301, 19.687049, 19.615529, 19.770825, 19.759215, 19.551591, 19.488482, 19.521235, 19.412712, 19.342366, 19.056148, 19.038306, 18.841366, 19.063528, 18.956866, 18.967774, 18.801031, 18.532908, 18.43296, 18.261797, 18.14839, 18.013686, 18.15375, 18.062945, 18.019409, 17.852611, 18.020623, 17.949819, 17.709087, 17.677533, 17.724655, 17.713189, 17.557634, 17.532205, 17.407359, 17.374107, 17.085566, 17.123219, 16.966197, 17.110662, 16.911235, 16.785015, 16.889247, 16.680779, 16.758876, 16.838571, 16.693097, 16.766398, 16.840725, 16.911468, 16.7573, 17.104833, 16.946411, 16.984333, 16.895301, 16.759273, 16.838379, 16.638433, 16.570906, 16.484367, 16.217608])
    big_fast = np.array([75.867571, 75.674346, 75.464712, 75.319441, 74.985851, 74.887038, 74.613743, 74.299785, 74.217, 74.039123, 73.786453, 73.608874, 73.34294, 73.091168, 72.840844, 72.623756, 72.50703, 72.340612, 72.106065, 71.902769, 71.711139, 71.428285, 71.151281, 70.838133, 70.827159, 70.64669, 70.36286, 70.12444, 69.927298, 69.746333, 69.618219, 69.309116, 69.098773, 69.02008, 68.640317, 68.585243, 68.368555, 68.232029, 67.953265, 67.791874, 67.607494, 67.345927, 67.148998, 66.901049, 66.709551, 66.491016, 66.369149, 66.16142, 66.01434, 65.777763, 65.817773, 65.385397, 65.328162, 65.09268, 64.887164, 64.69378, 64.530187, 64.25454, 64.092667, 64.046023, 63.781096, 63.654123, 63.369443, 63.153541, 63.036197, 62.755882, 62.714108, 62.585279, 62.447826, 62.116086, 61.87789, 61.87602, 61.685073, 61.491749, 61.224197, 61.093249, 61.001782, 60.670049, 60.494478, 60.402271, 60.269163, 59.997542, 59.766473, 59.681816, 59.506271, 59.320413, 59.175951, 59.136311, 58.812458, 58.629211, 58.377198, 58.330122, 58.133961, 57.980447, 57.806163, 57.547111, 57.411142, 57.255876, 57.192889, 57.03107, 56.760185, 56.586835, 56.409286, 56.412069, 56.010233, 55.992488, 55.860022, 55.63791, 55.560019, 55.289017, 55.122768, 55.157738, 54.755139, 54.609276, 54.512703, 54.304452, 54.193882, 54.241422, 53.99621, 53.724026, 53.651452, 53.316292, 53.158837, 53.044805, 52.877669, 52.728707, 52.618905, 52.453862, 52.260831, 52.067185, 51.846979, 51.961617, 51.738892, 51.577111, 51.397401, 51.281051, 51.165973, 50.959531, 50.799761, 50.711495, 50.533782, 50.526843, 50.212583, 50.158556, 49.885935, 49.834326, 49.631988, 49.436077, 49.555483, 49.128433, 49.025709, 48.90031, 48.807891, 48.571563, 48.483553, 48.408872, 48.28518, 48.18379, 48.003861, 47.874506, 47.615113, 47.651515, 47.354001, 47.321995, 47.262392, 46.962281, 46.792175, 46.747006, 46.614556, 46.237301, 46.334902, 46.052728, 46.073955, 45.882206, 45.697251, 45.64685, 45.439548, 45.268919, 45.180281, 45.1329, 44.93034, 44.753345, 44.654842, 44.548441, 44.464432, 44.301489, 44.277507, 43.962417, 43.860117, 43.815631, 43.641467, 43.479309, 43.39618, 43.085873, 43.135108, 42.922233, 42.851764, 42.834139, 42.573087, 42.56293, 42.417348, 42.230246, 42.103356, 42.066216, 41.818531, 41.625442, 41.802725, 41.556199, 41.360194, 41.105939, 41.160877, 41.098842, 40.893396, 40.807768, 40.852249, 40.598039, 40.475245, 40.26171, 40.240313, 40.169158, 40.090704, 39.866753, 39.875825, 39.679384, 39.439094, 39.350119, 39.311956, 39.179568, 39.064869, 38.891175, 38.758017, 38.68408, 38.650424, 38.517946, 38.414403, 38.343129, 38.192807, 37.990456, 38.072108, 37.879494, 37.812233, 37.652654, 37.427623, 37.396317, 37.402012, 37.135628, 37.027877, 36.904505, 36.808321, 36.76479, 36.628432, 36.500438, 36.37058, 36.353832, 36.090707, 36.141566, 35.953026, 35.70418, 35.698214, 35.621345, 35.455117, 35.427508, 35.218739, 35.265583, 35.203532, 34.917335, 34.958167, 34.775566, 34.725991, 34.620452, 34.733003, 34.428196, 34.375628, 34.033867, 34.152275, 34.121834, 33.974378, 33.824509, 33.684708, 33.637351, 33.556081, 33.334765, 33.311002, 33.081089, 33.148346, 33.037715, 32.742001, 32.789788, 32.729636, 32.696596, 32.528929, 32.458055, 32.470495, 32.180297, 32.157628, 32.039117, 31.869872, 31.946617, 31.618671, 31.931307, 31.678239, 31.464684, 31.456736, 31.336693, 31.206013, 31.000398, 31.058775, 30.86559, 30.854274, 30.770231, 30.799872, 30.529738, 30.395937, 30.458398, 30.265598, 30.156674, 30.162476, 30.068266, 29.909115, 29.815341, 29.799242, 29.730791, 29.607219, 29.426546, 29.406884, 29.355948, 29.354576, 29.124468, 28.982084, 29.071795, 28.925829, 28.807024, 28.741448, 28.65341, 28.663793, 28.503147, 28.423692, 28.474911, 28.219952, 28.211248, 28.106585, 28.076605, 27.945513, 27.965653, 27.84751, 27.87349, 27.634944, 27.5667, 27.552321, 27.391961, 27.25665, 27.239357, 27.064899, 27.04948, 26.886372, 26.978641, 26.846327, 26.693753, 26.660137, 26.617578, 26.489624, 26.47576, 26.399628, 26.281105, 26.188276, 26.1145, 26.20969, 26.033972, 25.906399, 25.943371, 25.797817, 25.535495, 25.562954, 25.505849, 25.255903, 25.417866, 25.257884, 25.149975, 25.127839, 25.083481, 24.930948, 25.033128, 24.895911, 24.713653, 24.784555, 24.689906, 24.498482, 24.410193, 24.5489, 24.401455, 24.402578, 24.174897, 24.140508, 24.111005, 23.987976, 23.871529, 23.896542, 23.822331, 23.693167, 23.667697, 23.595558, 23.483887, 23.560624, 23.398533, 23.338529, 23.232303, 23.154338, 23.012671, 23.10029, 23.036136, 22.805553, 22.897143, 22.821565, 22.829717, 22.691115, 22.523586, 22.575416, 22.465933, 22.523627, 22.249292, 22.164996, 22.144538, 22.090499, 22.127061, 21.977037, 21.919099, 21.891107, 21.853144, 21.707801, 21.616291, 21.583091, 21.423982, 21.387231, 21.428725, 21.381704, 21.406491, 21.230469, 21.093385, 21.016042, 21.115606, 20.960582, 20.976474, 20.901548, 20.690114, 20.590616, 20.773755, 20.687264, 20.622266, 20.538248, 20.448852, 20.368485, 20.309263, 20.289521, 20.176355, 20.056614, 20.074821, 20.087634, 19.955732, 19.722513, 19.759365, 19.682226, 19.780911, 19.627525, 19.574198, 19.480296, 19.415445, 19.442696, 19.486688, 19.413401, 19.238752, 19.277873, 18.923434, 19.006663, 19.126545, 18.910518, 18.856449, 18.873225, 18.750591, 18.75799, 18.755589, 18.733424, 18.639993, 18.591007, 18.504274, 18.449243, 18.455568, 18.207876, 18.486379, 18.218937, 18.221644, 18.205116, 18.044327, 18.081529, 17.905628, 17.875359, 17.864223, 17.783772, 17.720126, 17.712301, 17.632891, 17.6265, 17.43676, 17.457228, 17.479173, 17.276309, 17.257273, 17.256486, 17.335786, 17.105169, 17.064333, 16.930991, 17.130891, 16.824245, 16.837631, 16.766179, 16.930182, 16.796432, 16.734037, 16.756008, 16.608724, 16.427023, 16.601639, 16.440165, 16.418513, 16.361424, 16.385981, 16.158464, 16.209192, 16.118535, 16.24747, 16.034261, 15.899362, 15.966723, 15.871401, 15.966037, 15.931569, 15.705883])

    times = [times_ss, times_sf, times_bs, times_bf]
    all_sets = [small_slow, small_fast, big_slow, big_fast]

    h = [155.7617, 181.0233, 72.6630, 78.9960]
    emissivity = 0.6
    sigma = 5.67 * (10**(-8))

    # Fit the exponential model
    a_params = [0, 0, 0, 0]
    b_params = [0, 0, 0, 0]
    covariances = [0, 0, 0, 0]
    titles = ["Small, 10m/s", "Small, 15m/s", "Big 10m/s", "Big 15m/s"]

    for count, dataset in enumerate(all_sets):
        temp, temp_c = curve_fit(exponential_func, times[count], dataset, p0=(1, -0.1))
        covariances[count] = temp_c
        a_params[count], b_params[count] = temp
        perr = np.sqrt(np.diag(covariances[count]))
        a_err, b_err = perr
        confidence_interval = 1.96
        y_fit = exponential_func(times[count], a_params[count], b_params[count])
        y_fit_upper = exponential_func(times[count], a_params[count] + confidence_interval * a_err,
                                       b_params[count] + confidence_interval * b_err)
        y_fit_lower = exponential_func(times[count], a_params[count] - confidence_interval * a_err,
                                       b_params[count] - confidence_interval * b_err)

        plt.scatter(times[count], [x + (100 - dataset[0]) for x in dataset], label=titles[count])
        plt.plot(times[count], [x + (100 - dataset[0]) for x in y_fit],
                 label=f'Fit: y = {a_params[count]:.2f} * exp({b_params[count]:.2f} * x)', color='red')
        plt.fill_between(times[count], [x + (100 - dataset[0]) for x in y_fit_lower],
                         [x + (100 - dataset[0]) for x in y_fit_upper], color='gray', alpha=0.3, label='_')

        convecs = []
        rads = []
        for i, time in enumerate(times[count]):
            convecs.append(h[count] * (dataset[i]))
            rads.append(sigma * emissivity * ((dataset[i] + dataset[0])**4 - dataset[0]**4))
        print(titles[count])
        print(np.average(convecs), np.average(rads))
        print(np.average(convecs) + np.average(rads))

        # plt.scatter(times[count], dataset, label=titles[count])
        # plt.plot(times[count], y_fit, label=f'Fit: θ(t) = {a_params[count]:.2f} * exp({b_params[count]:.2f} * t)',
        #          color='red')
        # plt.fill_between(times[count], y_fit_lower, y_fit_upper, color='gray', alpha=0.3, label='_')

        # print(titles[count])
        # print(f"a = {a_params[count]} ± {a_err}")
        # print(f"b = {b_params[count]} ± {b_err}")

    # Add legend and labels
    plt.legend()
    plt.xlabel('Time (s)')
    plt.ylabel('Temperature (C)')
    plt.title('Exponential Fits with 95% Confidence Interval')
    # plt.show()

    # print(f"a = {a_pol} ± {a_pol_err}")
    # print(f"b = {b_pol} ± {b_pol_err}")

    # print(f"a = {a_pain} ± {a_pain_err}")
    # print(f"b = {b_pain} ± {b_pain_err}")


ME431_lab2()
